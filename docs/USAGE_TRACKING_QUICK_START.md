# æ‡‰ç”¨æƒ…å¢ƒåœç•™ API - å¿«é€Ÿé–‹å§‹

## âœ… å·²å®Œæˆçš„å¯¦æ–½

### 1. å»ºç«‹å…±ç”¨æœå‹™ (`src/services/usageTracking.ts`)

æä¾›ä»¥ä¸‹å‡½æ•¸ï¼š
- `trackUsage()` - é€šç”¨è¿½è¹¤å‡½æ•¸
- `trackAudioStep()` - éŸ³é »å‰µä½œæ­¥é©Ÿè¿½è¹¤
- `trackVideoStep()` - å½±ç‰‡å‰µä½œæ­¥é©Ÿè¿½è¹¤ï¼ˆVideo.tsx ç”¨ï¼‰
- `trackVideoCreationStep()` - å½±ç‰‡å‰µä½œæ­¥é©Ÿè¿½è¹¤ï¼ˆVideoCreation.tsx ç”¨ï¼‰
- `trackPageVisit()` - é é¢è¨ªå•è¿½è¹¤

### 2. å·²æ•´åˆé é¢

#### âœ… éŸ³é »å‰µä½œ (`src/pages/Audio.tsx`)
- æ¯æ¬¡é»æ“Šã€Œä¸‹ä¸€æ­¥ã€æ™‚è‡ªå‹•è¿½è¹¤
- è¿½è¹¤ 5 å€‹æ­¥é©Ÿï¼šåŸºæœ¬è³‡è¨Š â†’ èªéŸ³æ¨¡å‹ â†’ æƒ…ç·’èª¿æ•´ â†’ æ–‡æ¡ˆç·¨è¼¯ â†’ AIç”Ÿæˆ

#### âœ… å½±ç‰‡å‰µä½œ (`src/pages/VideoCreation.tsx`)
- æ¯æ¬¡é»æ“Šã€Œä¸‹ä¸€æ­¥ã€æ™‚è‡ªå‹•è¿½è¹¤
- è¿½è¹¤ 5 å€‹æ­¥é©Ÿï¼šå½±ç‰‡æ¨™é¡Œ â†’ èªéŸ³æ¨¡å‹ â†’ é¸æ“‡ç´ æ â†’ å½±ç‰‡æƒ…å¢ƒ â†’ ç”Ÿæˆå½±ç‰‡

## ğŸ“‹ è¿½è¹¤è³‡æ–™ç¸½è¦½

### éŸ³é »å‰µä½œæ­¥é©Ÿ

| æ­¥é©Ÿ | action_id | action_name | now_page |
|:---:|-----------|-------------|----------|
| 1ï¸âƒ£ | `ai_audio_step1` | åŸºæœ¬è³‡è¨Š | åŸºæœ¬è³‡è¨Š |
| 2ï¸âƒ£ | `ai_audio_step2` | èªéŸ³æ¨¡å‹ | èªéŸ³æ¨¡å‹ |
| 3ï¸âƒ£ | `ai_audio_step3` | æƒ…ç·’èª¿æ•´ | æƒ…ç·’èª¿æ•´ |
| 4ï¸âƒ£ | `ai_audio_step4` | æ–‡æ¡ˆç·¨è¼¯ | æ–‡æ¡ˆç·¨è¼¯ |
| 5ï¸âƒ£ | `ai_audio_step5` | AIç”Ÿæˆ | AIç”Ÿæˆ |

### å½±ç‰‡å‰µä½œæ­¥é©Ÿ

| æ­¥é©Ÿ | action_id | action_name | now_page |
|:---:|-----------|-------------|----------|
| 1ï¸âƒ£ | `video_creation_step1` | å½±ç‰‡æ¨™é¡Œ | åŸºæœ¬è³‡è¨Š |
| 2ï¸âƒ£ | `video_creation_step2` | èªéŸ³æ¨¡å‹ | èªéŸ³æ¨¡å‹ |
| 3ï¸âƒ£ | `video_creation_step3` | é¸æ“‡ç´ æ | å½±åƒç´ æ |
| 4ï¸âƒ£ | `video_creation_step4` | å½±ç‰‡æƒ…å¢ƒ | å½±ç‰‡æƒ…å¢ƒæè¿° |
| 5ï¸âƒ£ | `video_creation_step5` | ç”Ÿæˆå½±ç‰‡ | AIç”Ÿæˆ |

## ğŸš€ å¦‚ä½•åœ¨æ–°é é¢ä½¿ç”¨

### æ­¥é©Ÿ 1ï¼šå°å…¥è¿½è¹¤å‡½æ•¸

```typescript
import { trackUsage, trackPageVisit } from '../services/usageTracking';
```

### æ­¥é©Ÿ 2ï¼šåœ¨é©ç•¶æ™‚æ©Ÿèª¿ç”¨

```typescript
// æ–¹å¼ 1ï¼šè¿½è¹¤è‡ªå®šç¾©äº‹ä»¶
await trackUsage({
  action_id: 'my_feature_action',
  action_name: 'æˆ‘çš„åŠŸèƒ½æ“ä½œ',
  now_page: 'æˆ‘çš„é é¢'
});

// æ–¹å¼ 2ï¼šè¿½è¹¤é é¢è¨ªå•
await trackPageVisit('è¨­å®šé é¢');
```

## ğŸ” å¦‚ä½•é©—è­‰è¿½è¹¤æ˜¯å¦æˆåŠŸ

### 1. é–‹å•Ÿç€è¦½å™¨é–‹ç™¼å·¥å…· (F12)

### 2. åˆ‡æ›åˆ° Console æ¨™ç±¤

æŸ¥çœ‹æ˜¯å¦æœ‰ä»¥ä¸‹æ—¥èªŒï¼š
```
ä½¿ç”¨æƒ…å¢ƒè¿½è¹¤ API å›æ‡‰: {"status":"success","message":"Customer Added 2"}
```

### 3. åˆ‡æ›åˆ° Network æ¨™ç±¤

1. ç¯©é¸ `rise.iii.org.tw`
2. æ‰¾åˆ° `customers/add/2` è«‹æ±‚
3. æŸ¥çœ‹ **Status**: æ‡‰è©²æ˜¯ `200 OK`
4. æŸ¥çœ‹ **Payload**: ç¢ºèªåƒæ•¸æ­£ç¢º
5. æŸ¥çœ‹ **Response**: æ‡‰è©²åŒ…å«æˆåŠŸè¨Šæ¯

## âš™ï¸ è‡ªå‹•å‚³é€çš„åƒæ•¸

ä»¥ä¸‹åƒæ•¸æœƒè‡ªå‹•è™•ç†ï¼Œç„¡éœ€æ‰‹å‹•è¨­å®šï¼š

| åƒæ•¸ | ä¾†æº | èªªæ˜ |
|-----|------|------|
| `mode` | å›ºå®šå€¼ | `"2"` |
| `app_id` | å›ºå®šå€¼ | `"114_å…‰éš¼"` |
| `device_id` | localStorage | ç”¨æˆ¶ ID |
| `ip` | localStorage | ç”¨æˆ¶ IP åœ°å€ |
| `view` | navigator.userAgent | è‡ªå‹•åˆ¤æ–· `"phone"` æˆ– `"PC"` |
| `time` | Date.now() | Unix timestamp |
| `use_time` | é è¨­å€¼ | `"0"` |

## ğŸ“Š API å›æ‡‰èªªæ˜

### âœ… æˆåŠŸå›æ‡‰ (Status Code: 200)

```json
{
  "status": "success",
  "message": "Customer Added 2"
}
```

### âŒ å¤±æ•—å›æ‡‰ (Status Code: 400)

```json
{
  "status": "error",
  "message": "éŒ¯èª¤è¨Šæ¯"
}
```

## ğŸ’¡ æ³¨æ„äº‹é …

1. âš ï¸ è¿½è¹¤å¤±æ•—ä¸æœƒå½±éŸ¿ä¸»åŠŸèƒ½é‹ä½œ
2. âš ï¸ è«‹å‹¿åœ¨çŸ­æ™‚é–“å…§é‡è¤‡è¿½è¹¤ç›¸åŒäº‹ä»¶
3. âš ï¸ ç¢ºä¿ç”¨æˆ¶å·²ç™»å…¥ï¼ˆlocalStorage æœ‰ç”¨æˆ¶è³‡è¨Šï¼‰
4. âœ… è¿½è¹¤å‡½æ•¸æ˜¯ç•°æ­¥çš„ï¼Œä½¿ç”¨ `await` ç­‰å¾…å®Œæˆ
5. âœ… éŒ¯èª¤æœƒè‡ªå‹•è¨˜éŒ„åˆ° consoleï¼Œä¾¿æ–¼é™¤éŒ¯

## ğŸ“„ å®Œæ•´æ–‡æª”

è©³ç´°èªªæ˜è«‹åƒé–±ï¼š[USAGE_TRACKING_API.md](./USAGE_TRACKING_API.md)

---

**å»ºç«‹æ—¥æœŸ**: 2025-01-07  
**ç‹€æ…‹**: âœ… å·²å®Œæˆä¸¦æ¸¬è©¦

